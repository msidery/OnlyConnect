<?php
// some of the code i used for badminton website. does database stuff. figure it out :P


require('../includes/constants.php');

// open database connection
$con = mysql_connect(DB_SERVER, DB_USER, DB_PASS);
if (!$con) {
	die('Could not connect: '.mysql_error());
}

mysql_select_db(DB_NAME, $con);

if ($title != 'news') {
	$qry = 'SELECT posts.contents FROM pages NATURAL JOIN page_posts NATURAL JOIN posts WHERE pages.name="'.$title.'" ORDER BY post_id';
	$result = mysql_query($qry);
	
	while($row = mysql_fetch_array($result))
	{
		echo $row['contents'];
	}
}
if ($title == 'contact') {
	$result = mysql_query("SELECT * FROM contacts ORDER BY contact_id");
	$count = 0;
	while($row = mysql_fetch_array($result))
	{
		$result2 = mysql_query("SELECT * FROM contacts WHERE contact_id=".$count);
		$num = mysql_num_rows ($result2);
		echo '<div class="content"><p><strong>'.$row['title'].'</strong><br/>';
		echo $row['name'].'<br/>';
		echo '<em><a href="mailto: '.$row['email'].'">'.$row['email'].'</a></em>';
		while ($num > 1) {
			$row = mysql_fetch_array($result);
			echo '<br/>';
			echo $row['name'].'<br/>';
			echo '<em><a href="mailto: '.$row['email'].'">'.$row['email'].'</a></em>';
			$num--;
		}
		echo "</p>\n</div>";
		$count++;
	}
}
elseif ($title == 'news') {
	$result = mysql_query("SELECT * FROM news ORDER BY news_id DESC");
	$count = mysql_num_rows($result) - 1;
	while($row = mysql_fetch_array($result))
	{
		$date = date( 'D jS M Y, H:ia', strtotime($row['date']) );
		echo '<div class="content">';
		echo '<h4 style="clear:both;">'.$row['title'].'</h4>';
		echo '<div style="float:right;margin: -10px 10px 5px; font-size:8pt;">'.$date.'</div>';
		echo '<hr/>';
		echo $row['content'];
		$qry = 'SELECT * FROM comments NATURAL JOIN news_comments WHERE news_id="'.$row['news_id'].'" ORDER BY comment_id ASC';
		$result2 = mysql_query($qry);
		while($row2 = mysql_fetch_array($result2))
		{
			echo '<div class="comment">';
			$date = date( 'D jS M Y, H:ia', strtotime($row2['date']) );
			echo '<div class="commenttitle">'.$row2['name'];
			echo '<div style="float:right;margin: 3px 10px; font-size:8pt;">'.$date.'</div></div><hr/>';
			echo $row2['contents'].'</div>';
		}
		echo '<div id="'.$count.'" class="addcomment">';
		echo '<div onclick="startcomment('.$count.')">Add Comment</div>';
		echo '</div></div>';
		$count--;
	}
}

// close connection
mysql_close($con);
include('temp.php');
?>



<?php

define('DB_SERVER', 'localhost');
define('DB_NAME', 'database name');
define('DB_USER', 'username');
define('DB_PASS', 'password');
?>